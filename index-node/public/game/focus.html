<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Focus Map</title>
  <style>
    :root {
      --bg: #0a1418;
      --tool-bg: #0f1e26;
      --chapter-bg: rgba(11, 24, 32, 0.6);
      --text: #e6f5ff;
      --accent: #00e5ff;
      --accent-dark: #00b8d4;
      --glow: rgba(0, 229, 255, 0.5);
      --glow-strong: rgba(0, 229, 255, 0.8);
      --card: #11232d;
      --deep: #0a1820;
    }

    body {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      background: var(--bg);
      color: var(--text);
      font-family: 'Georgia', serif;
      min-height: 100vh;
    }

    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      background: var(--bg);
      padding: 20px 40px;
      border-bottom: 6px solid var(--accent);
      box-shadow: 0 0 40px var(--glow);
      display: flex;
      justify-content: space-between;
      align-items: center;
      min-height: 80px;
    }

    nav a {
      color: #fff;
      font-size: 32px;
      font-weight: 900;
      text-decoration: none;
      letter-spacing: 5px;
    }

    nav a:hover { color: var(--accent); }

    nav .domain-tabs {
      display: flex;
      gap: 25px;
      flex-wrap: wrap;
    }

    .domain-tab {
      background: var(--deep);
      color: var(--text);
      border: 2px solid #1a4a5e;
      padding: 12px 32px;
      border-radius: 14px;
      cursor: pointer;
      font-weight: 800;
      font-size: 18px;
      transition: all 0.3s;
    }

    .domain-tab:hover,
    .domain-tab.active {
      background: var(--accent);
      color: #000;
      box-shadow: 0 0 30px var(--glow-strong);
      transform: scale(1.05);
    }

    .master-grid {
      display: grid;
      grid-template-columns: 1fr 420px;
      gap: 40px;
      margin-top: 100px;
      padding: 0 40px;
    }

    @media (max-width: 1200px) {
      .master-grid {
        grid-template-columns: 1fr;
        padding: 0 20px;
      }
      .master-grid > div:nth-child(2) {
        order: -1;
        display: flex;
        flex-direction: row;
        overflow-x: auto;
        gap: 20px;
        padding: 20px 0;
        margin-bottom: 40px;
      }
    }

    .tool-column { padding: 20px 0; }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    .focus-rite {
      text-align: center;
      margin: 80px auto;
      padding: 50px 40px;
      max-width: 800px;
      background: linear-gradient(135deg, rgba(15,30,38,0.7), rgba(10,20,24,0.8));
      border: 2px solid var(--accent);
      border-radius: 28px;
      box-shadow: 0 20px 80px rgba(0, 208, 255, 0.2);
    }

    .focus-rite h2 {
      font-size: 38px;
      font-weight: 900;
      color: var(--accent);
      letter-spacing: 5px;
      margin-bottom: 40px;
      text-shadow: 0 0 20px var(--glow);
      text-transform: uppercase;
    }

    .focus-rite p {
      font-size: 22px;
      line-height: 1.8;
      color: var(--text);
      margin: 35px 0;
      font-style: italic;
    }

    .mission-area {
      background: var(--card);
      padding: 60px;
      border-radius: 28px;
      border: 4px solid var(--accent);
      box-shadow: 0 20px 80px rgba(0, 208, 255, 0.2);
      margin: 50px 0;
    }

    #missionTitle {
      text-align: center;
      font-size: 34px;
      margin-bottom: 35px;
      color: var(--accent);
      text-shadow: 0 0 15px var(--glow);
    }

    .pillar h3 {
      color: var(--accent);
      font-size: 30px;
      margin: 35px 0 18px;
      text-shadow: 0 0 15px var(--glow);
    }

    textarea {
      width: 100%;
      padding: 22px;
      background: #0a1418;
      color: #fff;
      border: 3px solid #1a4a5e;
      border-radius: 16px;
      font-size: 19px;
      min-height: 150px;
      resize: vertical;
      transition: all 0.4s;
      font-family: 'Georgia', serif;
    }

    textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 30px var(--glow-strong);
      outline: none;
    }

    button {
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: #000;
      padding: 18px 40px;
      border: none;
      border-radius: 16px;
      font-size: 20px;
      font-weight: 900;
      cursor: pointer;
      margin: 40px auto 20px;
      display: block;
      box-shadow: 0 12px 35px rgba(0, 208, 255, 0.4);
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    button:hover { transform: translateY(-4px); }

    .chapter-wrapper {
      margin: 60px 0;
      padding: 40px;
      border-radius: 24px;
      border: 2px solid rgba(0, 229, 255, 0.4);
      background: var(--chapter-bg);
    }

    .chapter-title {
      font-size: 32px;
      color: var(--accent);
      text-align: center;
      margin-top: 0;
      letter-spacing: 4px;
    }

    .month-card {
      background: var(--deep);
      color: var(--text);
      border: 2px solid #1a4a5e;
      padding: 22px;
      border-radius: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      min-width: 200px;
    }

    .month-card.active,
    .month-card:hover {
      border-color: var(--accent);
      box-shadow: 0 0 24px var(--glow-strong);
      color: var(--accent);
    }

    .chapter-content {
      background: rgba(0,0,0,0.4);
      border-radius: 18px;
      padding: 22px;
      line-height: 1.8;
    }
  </style>
  <script src="/vendor/marked/marked.min.js" defer></script>
</head>
<body>
<nav>
  <div class="domain-tabs" style="display:flex; gap:25px;">
    <button class="domain-tab active" data-domain="BODY">BODY</button>
    <button class="domain-tab" data-domain="BEING">BEING</button>
    <button class="domain-tab" data-domain="BALANCE">BALANCE</button>
    <button class="domain-tab" data-domain="BUSINESS">BUSINESS</button>
  </div>
  <a href="/game/" style="font-size:32px; font-weight:900; letter-spacing:5px; color:#fff;">αOS:::</a>
</nav>

<div class="master-grid" style="grid-template-columns: 1fr 420px; gap:40px; margin-top:140px; padding:0 40px;">
  <div class="tool-column">
    <div class="container">
      <div class="mission-area">
        <h2 id="missionTitle" style="text-align:center; font-size:36px; margin-bottom:40px;">BODY – CURRENT MONTH</h2>
        <div class="pillar"><h3>HABITS</h3><textarea id="habitsText" placeholder="Täglich. Non-negotiable."></textarea></div>
        <div class="pillar"><h3>ROUTINES</h3><textarea id="routinesText" placeholder="Zeitblöcke. Eisenhart."></textarea></div>
        <div class="pillar"><h3>ADDITIONS</h3><textarea id="additionsText" placeholder="Neue Waffen. Neue Brüder."></textarea></div>
        <div class="pillar"><h3>ELIMINATIONS</h3><textarea id="eliminationsText" placeholder="Totgewicht verbrennen."></textarea></div>
        <button id="lockBtn" onclick="saveMission(false)">LOCK THIS MISSION</button>
        <button onclick="saveMission(true)">LOCK → TICKTICK</button>
      </div>

      <div class="chapter-wrapper">
        <h2 class="chapter-title">FOKUS</h2>
        <div class="chapter-body">
          <div id="chapter34-md" class="chapter-content"></div>
        </div>
      </div>
    </div>
  </div>

  <div style="display:flex; flex-direction:column; gap:30px; padding:40px 0; align-items:center;">
    <div class="focus-rite">
      <p>THE FOCUS RITE</p>
      <p>
        Du trittst aus dem Nebel.<br>
        Du schärfst dein Schwert auf einen einzigen Punkt.<br>
        Und du schneidest alles weg, was dich vom Ziel trennt.
      </p>
      <p>
        Die Focus Map ist keine To-do-Liste.<br>
        Sie ist dein Laser.<br>
        Dein Befehl.<br>
        Dein unaufhaltsamer Wille.
      </p>
      <p>
        Wähle deinen Zeitraum.<br>
        Wähle deine Domäne.<br>
        Und dann – schneide.
      </p>
    </div>
    <div class="month-card active" data-month="current"><div class="icon">CURRENT</div><h2>DECEMBER 2025</h2></div>
    <div class="month-card" data-month="q1"><div class="icon">Q1</div><h2>JAN – MAR 2026</h2></div>
    <div class="month-card" data-month="q2"><div class="icon">Q2</div><h2>APR – JUN 2026</h2></div>
    <div class="month-card" data-month="q3"><div class="icon">Q3</div><h2>JUL – SEP 2026</h2></div>
    <div class="month-card" data-month="q4"><div class="icon">Q4</div><h2>OCT – DEC 2026</h2></div>
  </div>
</div>

<script>
let currentMonth = 'current';
let currentDomain = 'BODY';

function updateActiveStates() {
  document.querySelectorAll('.month-card').forEach(c =>
    c.classList.toggle('active', c.dataset.month === currentMonth));
  document.querySelectorAll('nav .domain-tab').forEach(b =>
    b.classList.toggle('active', b.dataset.domain === currentDomain));
}

function updateMissionTitle() {
  const label = currentMonth === 'current' ? 'CURRENT MONTH' : currentMonth.toUpperCase() + ' MISSION';
  const titleEl = document.getElementById('missionTitle');
  if (titleEl) titleEl.textContent = `${currentDomain} – ${label}`;
}

function selectMonth(month) {
  if (currentMonth === month) return;
  currentMonth = month;
  updateActiveStates();
  updateMissionTitle();
}

function selectDomain(domain) {
  if (currentDomain === domain) return;
  currentDomain = domain;
  updateActiveStates();
  updateMissionTitle();
}

async function saveMission(ticktick) {
  const h = document.getElementById('habitsText')?.value.trim() || '';
  const r = document.getElementById('routinesText')?.value.trim() || '';
  const a = document.getElementById('additionsText')?.value.trim() || '';
  const e = document.getElementById('eliminationsText')?.value.trim() || '';

  if (!h || !r || !a || !e) {
    alert('ALLE VIER PFEILER MÜSSEN GEFÜLLT SEIN – KEINE SCHWÄCHE.');
    return;
  }

  const monthName = currentMonth === 'current'
    ? new Date().toLocaleString('default', { month: 'long', year: 'numeric' })
    : currentMonth.toUpperCase();

  const header = [
    `# FOCUS MAP – ${currentDomain}`,
    `**Month:** ${monthName}`,
    `**Phase:** ${currentMonth}`,
    `**Date:** ${new Date().toLocaleDateString('de-DE')}`,
    '',
    '---',
    ''
  ].join('\n');

  const body = [
    `**Habits**\n${h || '-'}`,
    `**Routines**\n${r || '-'}`,
    `**Additions**\n${a || '-'}`,
    `**Eliminations**\n${e || '-'}`
  ].join('\n\n');

  const markdown = header + body;
  const title = `${currentDomain}_focus_${monthName}`;

  try {
    const res = await fetch('/api/game/export', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ map: 'focus', title, markdown, ticktick: !!ticktick })
    });
    const data = await res.json();
    if (!data.ok) throw new Error(data.error || 'save failed');
    alert(`${currentDomain} ${monthName} → LOCKED`);
    document.querySelectorAll('textarea').forEach(t => t.value = '');
  } catch (err) {
    alert('Fehler beim Speichern: ' + err.message);
  }
}

function renderChapter34() {
  const focusChapter = `
Ein großer Traum allein reicht nicht.  
Wenn du ihn nicht in kleine, machbare Schritte zerlegst, wirkt der Weg überwältigend – und das Ziel bleibt unerreichbar.

Der Horizont mag hell leuchten.  
Doch zwischen dir und diesem Horizont liegt ein weiter Ozean.  
**Wie überquerst du ihn?**  
Indem du dich auf die nächste Welle konzentrierst – auf die unmittelbare Herausforderung.

Genau darum geht es in der **Focus Map**.  
Die Focus Map schlägt die Brücke zwischen deinem aktuellen Standort und dem Ort, an den du gelangen willst.  
Der Horizont steht für deine Freiheit.  
Die Focus Map zeigt dir, wie du die ersten Meilen meisterst.

### 1. DIE REISE VERKLEINERN
Auf einer langen Reise ist es entscheidend, den Weg in Etappen zu gliedern.  
So wird das Große beherrschbar – und du bleibst auf Kurs.  
Die Focus Map ist dein nächster klarer Schritt:  
Sie zerlegt deine große Vision in konkrete, umsetzbare Handlungen.

### 2. DAS FUNDAMENT BAUEN
Denk an den Bau eines Wolkenkratzers.  
Ohne solides Fundament stürzt selbst das größte Bauwerk ein.

Deine erste monatliche Focus Map dient genau diesem Zweck:  
Sie legt die Basis – Gewohnheiten, Routinen, Ressourcen und Menschen – die deinen Aufstieg in Richtung IPW tragen.

- **Gewohnheiten:** Die täglichen Handlungen, die das Tempo bestimmen. Sie bilden das Rückgrat.
- **Routinen:** Verlässliche Muster. Geblockte Zeit. Nicht verhandelbar.
- **Hinzufügen & Eliminieren:** Neue Werkzeuge, Fähigkeiten, Verbündete hinein – Ballast hinaus.

### 3. DIE SEGEL SETZEN
Die Focus Map ist dein Signal, den Hafen zu verlassen und dem offenen Meer zu begegnen.  
Es geht darum, den ersten umsetzbaren Schritt zu machen – egal wie klein er erscheint.

### 4. DEN WEG EHREN – NICHT NUR DAS ZIEL
Jede Welle, die du meisterst, formt den Mann, der du wirst.  
Der Weg ist ebenso heilig wie der Gipfel.

> **Setze die Segel.  
> Umarme die Herausforderungen.  
> Lass uns diesen Ozean überqueren – einen fokussierten Monat nach dem anderen.**

---
`;

  const el = document.getElementById('chapter34-md');
  if (!el) return;
  if (!window.marked) {
    el.textContent = focusChapter;
    return;
  }
  el.innerHTML = marked.parse(focusChapter);
}

window.addEventListener('load', () => {
  document.querySelectorAll('.month-card').forEach(card => {
    card.addEventListener('click', () => selectMonth(card.dataset.month));
  });

  document.querySelectorAll('nav .domain-tab').forEach(tab => {
    tab.addEventListener('click', () => selectDomain(tab.dataset.domain));
  });

  const lockBtn = document.getElementById('lockBtn');
  if (lockBtn) lockBtn.addEventListener('click', () => saveMission(false));

  updateActiveStates();
  updateMissionTitle();
  renderChapter34();
});
</script>

</body>
</html>
