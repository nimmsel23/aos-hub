[Unit]
Description=AlphaOS Local Index Node Dev (UI Router)
Wants=network-online.target
After=network-online.target

[Service]
Type=simple
WorkingDirectory=%h/aos-hub/index-node
Environment=NODE_ENV=development
Environment=HOST=0.0.0.0
Environment=PORT=8799
Environment=CORE4_STORAGE_FALLBACK_DIR=%h/.local/share/alphaos/core4
ExecStart=/usr/bin/npm run dev
Restart=on-failure
RestartSec=1
CapabilityBoundingSet=
AmbientCapabilities=

# Logs
StandardOutput=journal
StandardError=journal

# Hardening (safe defaults for local service)
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=read-only

# Node needs to read the repo (menu.yaml + public/*). No write required.
ReadOnlyPaths=%h/aos-hub/index-node

# Taskwarrior and exports need write access
ReadWritePaths=%h/.task
ReadWritePaths=%h/.local/share/alphaos
ReadWritePaths=%h/.alpha_os
ReadWritePaths=%h/AlphaOS-Vault
ReadWritePaths=%h/Dokumente/AlphaOs-Vault
ReadWritePaths=%h/Dokumente/AlphaOS-Vault

ProtectControlGroups=true
ProtectKernelTunables=true
ProtectKernelModules=true
LockPersonality=true
RestrictSUIDSGID=true

[Install]
WantedBy=default.target
